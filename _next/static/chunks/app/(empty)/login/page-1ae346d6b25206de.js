(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5123],{6110:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>g});var a=t(95155),s=t(11518),o=t.n(s),i=t(12115),n=t(35695),l=t(12543),d=t(91721),c=t(31573),m=t(55988),f=t(79971),u=t(6874),p=t.n(u);function g(){let[e,r]=(0,i.useState)({email:"",password:""}),[t,s]=(0,i.useState)(!1),[u,g]=(0,i.useState)(!1),[x,h]=(0,i.useState)(""),y=(0,n.useRouter)(),j=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),b=async r=>{if(r.preventDefault(),s(!0),g(!1),h(""),!j(e.email)){g(!0),h("Por favor, ingresa un email v\xe1lido."),s(!1);return}try{let r=await m.A.login(e);if(r.error)throw Error(r.message);(0,f.setCookie)("token",r.token,{maxAge:2592e3,path:"/"});let t=await m.A.me();if(t.error)throw Error("Error al obtener informaci\xf3n del usuario");(0,f.setCookie)("user",JSON.stringify(t.user),{maxAge:2592e3,path:"/"}),t.empleado&&(0,f.setCookie)("empleado",JSON.stringify(t.empleado),{maxAge:2592e3,path:"/"}),t.rol&&(0,f.setCookie)("rol",t.rol,{maxAge:2592e3,path:"/"}),m.A.isAdmin()||m.A.hasRole("marketing")||m.A.hasRole("ventas"),y.push("/dashboard/main")}catch(e){g(!0),h(e.message||"Email o contrase\xf1a incorrectos.")}finally{s(!1)}},k=t=>{r({...e,[t.target.id]:t.target.value})};return(0,a.jsxs)("div",{className:"jsx-9adf6f105a1d0883 flex flex-col lg:flex-row min-h-screen bg-gray-50",children:[(0,a.jsx)("div",{className:"jsx-9adf6f105a1d0883 lg:w-1/2 w-full bg-gradient-to-br from-violet-600 via-purple-600 to-indigo-700 flex flex-col items-center justify-center p-8 relative overflow-hidden",children:(0,a.jsxs)("div",{className:"jsx-9adf6f105a1d0883 relative z-10 text-center",children:[(0,a.jsx)("h1",{className:"jsx-9adf6f105a1d0883 text-4xl lg:text-5xl font-bold text-white mb-6",children:"\xa1Bienvenido!"}),(0,a.jsx)("p",{className:"jsx-9adf6f105a1d0883 text-white/90 text-lg mb-8 max-w-md",children:"Accede a tu cuenta para gestionar tus recursos y servicios"}),(0,a.jsx)("img",{src:"/login/sesion.webp",alt:"Inicio de sesi\xf3n",className:"jsx-9adf6f105a1d0883 w-64 lg:w-80 h-auto mx-auto animate-float"})]})}),(0,a.jsxs)("div",{className:"jsx-9adf6f105a1d0883 lg:w-1/2 w-full flex flex-col items-center justify-center p-6 relative",children:[(0,a.jsx)("a",{href:"/",className:"jsx-9adf6f105a1d0883 absolute top-4 right-4",children:(0,a.jsxs)("button",{className:"jsx-9adf6f105a1d0883 flex items-center gap-2 bg-white/80 backdrop-blur-sm px-4 py-2 rounded-lg hover:bg-white hover:scale-105 transition-all duration-300 shadow-lg text-gray-700",children:[(0,a.jsx)(l.A,{className:"w-4 h-4"}),"Regresar"]})}),(0,a.jsxs)("div",{className:"jsx-9adf6f105a1d0883 bg-white p-8 lg:p-10 rounded-2xl shadow-xl w-full max-w-md border border-gray-100",children:[(0,a.jsxs)("div",{className:"jsx-9adf6f105a1d0883 text-center mb-8",children:[(0,a.jsx)("h2",{className:"jsx-9adf6f105a1d0883 text-3xl font-bold bg-gradient-to-r from-violet-600 to-indigo-600 bg-clip-text text-transparent",children:"Iniciar Sesi\xf3n"}),(0,a.jsx)("p",{className:"jsx-9adf6f105a1d0883 text-gray-500 mt-2",children:"Ingresa tus credenciales para continuar"})]}),u&&(0,a.jsx)("div",{className:"jsx-9adf6f105a1d0883 bg-red-50 border-l-4 border-red-500 p-4 mb-6 rounded-r",children:(0,a.jsx)("p",{className:"jsx-9adf6f105a1d0883 text-red-700 text-sm",children:x||"Usuario o contrase\xf1a incorrectos. Por favor, intenta nuevamente."})}),(0,a.jsxs)("form",{onSubmit:b,className:"jsx-9adf6f105a1d0883 space-y-6",children:[(0,a.jsxs)("div",{className:"jsx-9adf6f105a1d0883 space-y-2",children:[(0,a.jsx)("label",{htmlFor:"email",className:"jsx-9adf6f105a1d0883 block text-sm font-medium text-gray-700",children:"Usuario"}),(0,a.jsxs)("div",{className:"jsx-9adf6f105a1d0883 relative",children:[(0,a.jsx)("div",{className:"jsx-9adf6f105a1d0883 absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(d.A,{className:"h-5 w-5 text-gray-400"})}),(0,a.jsx)("input",{type:"text",id:"email",value:e.email,onChange:k,placeholder:"Ingresa tu usuario",required:!0,className:"jsx-9adf6f105a1d0883 block w-full pl-10 pr-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500 focus:border-violet-500 bg-gray-50 transition-colors duration-200"})]})]}),(0,a.jsxs)("div",{className:"jsx-9adf6f105a1d0883 space-y-2",children:[(0,a.jsx)("label",{htmlFor:"password",className:"jsx-9adf6f105a1d0883 block text-sm font-medium text-gray-700",children:"Contrase\xf1a"}),(0,a.jsxs)("div",{className:"jsx-9adf6f105a1d0883 relative",children:[(0,a.jsx)("div",{className:"jsx-9adf6f105a1d0883 absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(c.A,{className:"h-5 w-5 text-gray-400"})}),(0,a.jsx)("input",{type:"password",id:"password",value:e.password,onChange:k,placeholder:"Ingresa tu contrase\xf1a",required:!0,className:"jsx-9adf6f105a1d0883 block w-full pl-10 pr-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500 focus:border-violet-500 bg-gray-50 transition-colors duration-200"})]})]}),(0,a.jsx)("div",{className:"jsx-9adf6f105a1d0883 mt-4",children:(0,a.jsx)(p(),{href:"./email/",className:"text-sm text-blue-500 hover:underline",children:"\xbfOlvidaste tu contrase\xf1a?"})}),(0,a.jsx)("button",{disabled:t,type:"submit",className:"jsx-9adf6f105a1d0883 w-full bg-gradient-to-r from-[#90388b] to-indigo-600 text-white py-3 px-4 rounded-lg font-medium hover:opacity-90 focus:ring-2 focus:ring-offset-2 focus:ring-violet-500 disabled:opacity-50 hover:scale-105 transition-all duration-300 disabled:cursor-not-allowed",children:t?(0,a.jsxs)("span",{className:"jsx-9adf6f105a1d0883 flex items-center justify-center gap-2",children:[(0,a.jsxs)("svg",{viewBox:"0 0 24 24",className:"jsx-9adf6f105a1d0883 animate-spin h-5 w-5",children:[(0,a.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none",className:"jsx-9adf6f105a1d0883 opacity-25"}),(0,a.jsx)("path",{fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",className:"jsx-9adf6f105a1d0883 opacity-75"})]}),"Iniciando sesi\xf3n..."]}):"Iniciar Sesi\xf3n"})]})]})]}),(0,a.jsx)(o(),{id:"9adf6f105a1d0883",children:"@-webkit-keyframes float{0%,100%{-webkit-transform:translatey(0);transform:translatey(0)}50%{-webkit-transform:translatey(-20px);transform:translatey(-20px)}}@-moz-keyframes float{0%,100%{-moz-transform:translatey(0);transform:translatey(0)}50%{-moz-transform:translatey(-20px);transform:translatey(-20px)}}@-o-keyframes float{0%,100%{-o-transform:translatey(0);transform:translatey(0)}50%{-o-transform:translatey(-20px);transform:translatey(-20px)}}@keyframes float{0%,100%{-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}50%{-webkit-transform:translatey(-20px);-moz-transform:translatey(-20px);-o-transform:translatey(-20px);transform:translatey(-20px)}}.animate-float.jsx-9adf6f105a1d0883{-webkit-animation:float 6s ease-in-out infinite;-moz-animation:float 6s ease-in-out infinite;-o-animation:float 6s ease-in-out infinite;animation:float 6s ease-in-out infinite}"})]})}},30313:(e,r,t)=>{Promise.resolve().then(t.bind(t,6110))},31670:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a="https://back.digimediamkt.com"},55988:(e,r,t)=>{"use strict";t.d(r,{A:()=>l});var a=t(31670),s=t(79971);let o="".concat(a.A,"/api"),i=function(e,r){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a={path:"/",maxAge:86400,sameSite:"lax",...t};if("user"===e&&r&&"object"==typeof r){let t={id:r.id,name:r.name,email:r.email};(0,s.setCookie)(e,JSON.stringify(t),a);return}if("empleado"===e&&r&&"object"==typeof r){let t={id_empleado:r.id_empleado,nombre:r.nombre,apellido:r.apellido,email:r.email,id_rol:r.id_rol};(0,s.setCookie)(e,JSON.stringify(t),a);return}if("subtipoAdmin"===e&&r&&"object"==typeof r){let t={description:r.description,hierarchy:r.hierarchy};(0,s.setCookie)(e,JSON.stringify(t),a);return}let o="object"==typeof r?JSON.stringify(r):r;(0,s.setCookie)(e,o,a)},n={register:async e=>{try{let r=await fetch("".concat(o,"/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),t=await r.json();if(!r.ok)throw Error(t.message||"Error en el registro");return t.user&&(0,s.setCookie)("user",JSON.stringify(t.user),{maxAge:86400}),t}catch(e){return console.error("Error en registro:",e),{error:!0,message:e.message}}},login:async e=>{try{let r=await fetch("".concat(o,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),t=await r.json();if(console.log("Usuario autenticado: \n",t),!r.ok)throw Error(t.message||"Error en la autenticaci\xf3n");return i("token",t.token),i("user",t.user),t.empleado&&i("empleado",t.empleado),t.rol&&i("rol",t.rol),t.permisos&&i("permisos",t.permisos),t.empleado.subtipo_admin&&i("subtipoAdmin",t.empleado.subtipo_admin),t}catch(e){throw console.error("Error en login:",e),e}},logout:async()=>{try{let e=(0,s.getCookie)("token");if(!e)return{success:!0};let r=await fetch("".concat(o,"/logout"),{method:"POST",headers:{authorization:"Bearer ".concat(e)}}),t=await r.json();if(!r.ok)throw Error(t.message||"Error al cerrar sesi\xf3n");return n.clearAuthCookies(),t}catch(e){return console.error("Error en logout:",e),n.clearAuthCookies(),{error:!0,message:e.message}}},me:async()=>{try{let e=(0,s.getCookie)("token");if(!e)return null;let r=await fetch("".concat(o,"/me"),{method:"GET",headers:{authorization:"Bearer ".concat(e)}}),t=await r.json();if(!r.ok)throw 401===r.status&&n.clearAuthCookies(),Error(t.message||"Error al obtener informaci\xf3n del usuario");return t.user&&i("user",t.user),t.empleado&&i("empleado",t.empleado),t.rol&&i("rol",t.rol),t.permisos&&i("permisos",t.permisos),t}catch(e){return console.error("Error al obtener informaci\xf3n del usuario:",e),{error:!0,message:e.message}}},logoutClient:e=>{n.clearAuthCookies(),e&&e.push("/login")},clearAuthCookies:()=>{(0,s.deleteCookie)("token"),(0,s.deleteCookie)("user"),(0,s.deleteCookie)("empleado"),(0,s.deleteCookie)("rol"),(0,s.deleteCookie)("permisos"),(0,s.deleteCookie)("subtipoAdmin")},getCurrentUser:()=>{let e=(0,s.getCookie)("user");try{if(e)return"string"==typeof e?JSON.parse(e):e;return null}catch(e){return console.error("Error parsing user cookie:",e),null}},getCurrentEmpleado:()=>{let e=(0,s.getCookie)("empleado");try{if(e)return"string"==typeof e?JSON.parse(e):e;return null}catch(e){return console.error("Error parsing empleado cookie:",e),null}},getCurrentSubtipoAdmin:()=>{let e=(0,s.getCookie)("subtipoAdmin");try{if(e)return"string"==typeof e?JSON.parse(e):e;return null}catch(e){return console.error("Error parsing empleado cookie:",e),null}},getCurrentRole:()=>(0,s.getCookie)("rol")||null,getCurrentPermissions:()=>{let e=(0,s.getCookie)("permisos");try{return e?JSON.parse(e):[]}catch(e){return[]}},getToken:()=>(0,s.getCookie)("token"),hasRole:e=>{let r=n.getCurrentRole();return!!r&&r.toLowerCase()===e.toLowerCase()},hasPermission:e=>n.getCurrentPermissions().includes(e),hasAnyPermission:e=>{let r=n.getCurrentPermissions();return e.some(e=>r.includes(e))},isAdmin:()=>n.hasRole("administrador"),isAuthenticated:()=>!!(0,s.getCookie)("token"),refreshAuthData:async()=>await n.me(),isVerifiedAccount:()=>{let e=n.getCurrentUser();return(null==e?void 0:e.email)==="tmlighting@hotmail.com"}},l=n}},e=>{var r=r=>e(e.s=r);e.O(0,[9971,6874,6148,8441,1684,7358],()=>r(30313)),_N_E=e.O()}]);